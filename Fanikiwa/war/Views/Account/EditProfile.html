﻿﻿﻿﻿﻿﻿﻿﻿
<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Fanikiwa - Peer-to-Peer Lending</title>
<link href="/Images/Dollar.ico" rel="shortcut icon" type="image/x-icon" />
<link rel="stylesheet" href="/Content/Site.css" type="text/css" />
<script src="/Scripts/jquery-2.0.3.js" type="text/javascript"></script>
<script src="/Scripts/CustomScripts.js" type="text/javascript"></script>


</head>


<body>

	<header>
		<div class="content-wrapper">

			<div class="float-left">
				<p class="site-title" title="Fanikiwa - Peer - To - Peer Lending">
					Fanikiwa - Peer - To - Peer Lending</p>
			</div>


			<div class="float-right">
				<section id="login">
					<text> Welcome To Fanikiwa, <a id="lnkloggedinuser"
						style="cursor: pointer;" href="#" onclick="ManageProfile()"
						title="Manage Profile"></a> <a id="lnklogoff"
						style="cursor: pointer;" href="#" onclick="LogOff()"
						title="Log Off">Log off</a> </text>
				</section>
			</div>



			<div id="nav">
				<ul id="menu">

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitIndexForm" style="cursor: pointer;"
									href="/Views/Home/Index.html">Home</a>
							</div>

						</div>

					</li>


					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListLendOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListLendOffers.html">Get A loan</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListBorrowOffersForm" style="cursor: pointer;"
									href="/Views/Offers/ListBorrowOffers.html">Make An
									Investment</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitListMyOffersForm"
									href="/Views/Offers/ListMyOffers.html" style="cursor: pointer;">My
									Offers</a>
							</div>

						</div>

					</li>





					<li id="subMenuMyProfile">

						<div class="floatleft">

							<div>
								<a id="btnSubmitEditProfileSubForm"
									href="/Views/Account/EditProfile.html" style="cursor: pointer;">My
									Profile</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyAccounts">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyAccountsForm"
									href="/Views/Account/MyAccounts.html" style="cursor: pointer;">My
									Accounts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyInvestMentsForm"
									href="/Views/Offers/ListMyInvestments.html"
									style="cursor: pointer;">My InvestMents</a>
							</div>

						</div>

					</li>

					<li id="subMenuMyLoans">

						<div class="floatleft">

							<div>
								<a id="btnSubmitMyLoansForm"
									href="/Views/Loans/ListMyLoans.html" style="cursor: pointer;">My
									Loans</a>
							</div>

						</div>

					</li>

					<li id="subMenuOfferGroups">

						<div class="floatleft">

							<div>
								<a id="btnSubmitGetMyMailingGroupsForm"
									href="/Views/MailingGroups/MailingGroups.html"
									style="cursor: pointer;">My Offer Groups</a>
							</div>

						</div>

					</li>

					<li id="subMenuScores">

						<div class="floatleft">

							<div>
								<a id="btnSubmitOfferScoresForm"
									href="/Views/Account/ManageProfile.html"
									style="cursor: pointer;">My Offer Scores</a>
							</div>

						</div>

					</li>

					<li id="subMenuChangePassword">

						<div class="floatleft">

							<div>
								<a id="btnSubmitChangePasswordForm"
									href="/Views/Account/_ChangePasswordPartial.html"
									style="cursor: pointer;">Change Password</a>
							</div>

						</div>

					</li>

					<li id="subMenuDeRegister">

						<div class="floatleft">

							<div>
								<a id="btnSubmitDeRegisterForm"
									href="/Views/Account/DeRegister.html" style="cursor: pointer;">DeRegister</a>
							</div>

						</div>

					</li>





					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitHelpForm" href="/Views/Home/Help.html"
									style="cursor: pointer;">Help</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactUsForm"
									href="/Views/Contact/ContactUs.html" style="cursor: pointer;">Contact
									Us</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitContactsForm" href="/Views/Home/Contact.html"
									style="cursor: pointer;">Contacts</a>
							</div>

						</div>

					</li>

					<li>

						<div class="floatleft">

							<div>
								<a id="btnSubmitAboutForm" href="/Views/Home/About.html"
									style="cursor: pointer;">About</a>
							</div>

						</div>

					</li>



				</ul>
			</div>


		</div>


	</header>





	<div id="body">


		<section class="content-wrapper main-content clear-fix">

			<div id="error-display-div" class="displaynone"></div>


			<hgroup class="title">
				<h2 class="page-title">Edit Profile</h2>
			</hgroup>

			<form action="javascript:void(0);">

				<fieldset>
					<legend>Edit Profile</legend>

					<article class="col1">
						<div class="pad">

							<div>
								<label for="txtEmail">Email</label> <input id="txtDescription"
									placeholder="Email" autofocus="autofocus" type="text"></input>
							</div>

							<div>
								<label for="txtSurname">Surname</label> <input id="txtSurname"
									placeholder="Surname" type="text"></input>
							</div>

							<div>
								<label for="txtOtherNames">OtherNames</label> <input
									id="txtOtherNames" placeholder="OtherNames" type="text"></input>
							</div>

							<div>
								<label for="txtTelephone">Telephone</label> <input
									id="txtTelephone" placeholder="Telephone" type="tel"></input>
							</div>

							<div>
								<label for="txtNationalID">NationalID</label> <input
									id="txtNationalID" placeholder="NationalID" type="text"></input>
							</div>


						</div>
					</article>

					<article class="col2">
						<div class="pad">

							<div>
								<label for="dtpDateOfBirth">Date Of Birth</label> <input
									id="dtpDateOfBirth" placeholder="Term" type="date"></input>
							</div>

							<div>
								<label for="txtRefferedBy">RefferedBy</label> <input
									id="txtRefferedBy" placeholder="RefferedBy" type="text"></input>
							</div>


							<div>
								<label for="txtMaxRecordsToDisplay">MaxRecordsToDisplay</label>
								<input id="txtMaxRecordsToDisplay"
									placeholder="MaxRecordsToDisplay" type="text"></input>
							</div>

							<div>
								<label for="cboGender">Gender</label> <select name="Gender"
									id="cboGender">
									<option value="M">Male</option>
									<option value="F">Female</option>
								</select>
							</div>

							<div>
								<label for="cboInformBy">InformBy</label> <select
									name="InformBy" id="cboInformBy">
									<option value="E">Email</option>
									<option value="S">Sms</option>
								</select>
							</div>


						</div>
					</article>

					<input type="submit" value="Update" id="btnUpdateProfileForm"
						style="float: left; clear: both" />

				</fieldset>


			</form>


		</section>


	</div>





	<footer>

		<hr />


		<div class="content-wrapper clearboth">
			<div class="float-left">
				<p style="font-size: 15px">Copyright &copy; @DateTime.Now.Year -
					Software Providers Limited. All Rights Reserved.</p>
			</div>
		</div>


		<div class="content-wrapper clearboth">
			<div>

				<img src="/Images/fanikiwa_savings.jpg"
					alt="Fanikiwa - Peer - To - Peer Lending" /> <img
					src="/Images/images.jpg" alt="Fanikiwa - Peer - To - Peer Lending" />

				<img src="/Images/savingsimg.jpg"
					alt="Fanikiwa - Peer - To - Peer Lending" />

			</div>
		</div>


	</footer>




	<script type="text/javascript">
 
		 // Get loggedin user from the local storage
		 $('#lnkloggedinuser').text(localStorage.getItem('loggedinuser'));
     
		// var ROOT ='https://1-dot-fanikiwaweb.appspot.com/_ah/api';
		  var ROOT ='http://localhost:8888/_ah/api';   
	     function init() {
	      
		    // Parameters are APIName,APIVersion,CallBack function,API Root
		    gapi.client.load('memberendpoint', 'v1', null, ROOT);
	         
		    // wire the submit button
		    document.getElementById('btnUpdateProfileForm').onclick = function() {
		    UpdateProfile();
            }
            
            InitializeControls();
            
          }
         
         // function that will execute the getMemberByEmail call
         function  getMemberByEmail(email)
         {
     
        	try {
			     // make the api call
			     gapi.client.memberendpoint.getMemberByEmail(email).execute(function(resp) {
			     if (!resp.code) {       			 
	       		    return resp;       		
	       		}       		  
	       		else {
	       			console.log(resp.code + " : " + resp.message);
	       			alert("Error : " + resp.code + ":" + resp.message);
	       		}
		       	});
	       	
	       	} catch(exception) { 
	           localStorage.errormessage = exception;
	           console.log("Error : " + exception);
	           window.location.href = "/Views/Shared/Error.html"; 
	      }
		}	
		
        // function that will execute the UpdateProfile call
        function UpdateProfile() {
        
       	try {
        
        	// retrieve the entries
        	var _Email = document.getElementById('txtEmail').value;
        	var _Surname = document.getElementById('txtSurname').value;
        	var _OtherNames = document.getElementById('txtOtherNames').value;
        	var _Telephone = document.getElementById('txtTelephone').value;
        	var _NationalID = document.getElementById('txtNationalID').value;
        	var _DateOfBirth = document.getElementById('dtpDateOfBirth').value; 
        	var _RefferedBy = document.getElementById('txtRefferedBy').value;
        	var _MaxRecordsToDisplay = document.getElementById('txtMaxRecordsToDisplay').value;
        	var _Gender = document.getElementById('cboGender').value;
        	var _InformBy = document.getElementById('cboInformBy').value;
        	
            
        	// Build the Request Object
        	var member = {};
        	member.email = _Email;
        	member.surname = _Surname;
        	member.otherNames = _OtherNames;
        	member.telephone = _Telephone;
        	member.nationalID = _NationalID;
        	member.dateOfBirth = _DateOfBirth; 
        	member.refferedBy = _RefferedBy;
        	member.maxRecordsToDisplay = _MaxRecordsToDisplay;
        	member.gender = _Gender;
        	member.informBy = _InformBy;
        	
        	// make the api call
        	gapi.client.memberendpoint.updateMember(member).execute(function(resp) {
        		 console.log(resp);
        		if (!resp.code) {
        		 	 
        		window.location.href = "/Views/Shared/Successful.html";
        		
        		} 
        		else {
        			console.log(resp.code + " : " + resp.message);
        			alert("Error : " + resp.code + ":" + resp.message);
        		} 
        	});
        	
        	} catch(exception) { 
	           localStorage.errormessage = exception;
	           console.log("Error : " + exception);
	           window.location.href = "/Views/Shared/Error.html"; 
	      }
        }
        
        // function that will execute the InitializeControls call
        function InitializeControls() {
        
       	try {
         
        	// retrieve email from local storage
        	var email = localStorage.getItem('loggedinuser')  
        	// make the api call
            var member = getMemberByEmail({'email': email});
        
             // populate controls
             document.getElementById('txtEmail').value = member.email;
        	 document.getElementById('txtSurname').value = member.surname;
        	 document.getElementById('txtOtherNames').value = member.otherNames;
        	 document.getElementById('txtTelephone').value = member.telephone;
        	 document.getElementById('txtNationalID').value = member.nationalID;
        	 document.getElementById('dtpDateOfBirth').value = member.dateOfBirth; 
        	 document.getElementById('txtRefferedBy').value = member.refferedBy;
        	 document.getElementById('txtMaxRecordsToDisplay').value = member.maxRecordsToDisplay;
             document.getElementById('cboGender').value = member.gender;
        	 document.getElementById('cboInformBy').value = member.informBy;
        	
        	} catch(exception) { 
	           localStorage.errormessage = exception;
	           console.log("Error : " + exception);
	           window.location.href = "/Views/Shared/Error.html"; 
	      }
        }
        
            function LogOff() { 
	         	localStorage.removeItem("loggedinuser");
	            window.location.href = "/Views/Account/Login.html";  
         	}
         	
         	function ManageProfile() { 
         		window.location.href = "/Views/Account/EditProfile.html";  
            }
    </script>


	<script src="https://apis.google.com/js/client.js?onload=init"></script>



</body>


</html>
